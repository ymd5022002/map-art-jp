<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Leaflet Map</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
	<style>
        html,body,#map {
            height: 100%;
            width: 100%;
            font-family: sans-serif;
            background-color: #000;
            color: #fff;
        }
    </style>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
</head>
<body style="margin:0">
<table width=100% height=100%>
<tr>
<td height=23pt>
<div style="font-size:12pt;font-weight:900">超微地形用 干渉色標高図</div>

<span style="font-size:11pt">色周期(m)：0
    <input id="slider1" type="range" min="1" max="25" step="1" value="13" oninput="updateValue()" onmouseup="updateMap()" />
    <span id="maxValueText">
        <select id="maxValueSelect" onchange="changeMaxValue()">
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100">100</option>
            <option value="200">200</option>
            <option value="500">500</option>
            <option value="1000">1000</option>
            <option value="2000">2000</option>
            <option value="5000">5000</option>
        </select>
    　</span>
</span>

<span id="cc" style="font-size:11pt font-weight:900">13</span>
</tr>
<tr><td width=100%>
<div style="font-size:9pt;line-height:9pt"><hr size="1"></div>
    <div id="map"></div>
</td></tr>
<tr><td height=30pt>
    <div style="font-size:9pt;line-height:9pt"><hr size="1"></div>
    <div style="font-size:9pt;line-height:9pt">出典：地理院タイル</div>
    <span style="font-size:9pt;line-height:9pt">地図アート研究所×Code for History｜干渉色標高図</span>
</td</tr>
</table>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script>
        var map = L.map('map').setView([35.6895, 139.6917], 10);
        var initialC = 13; // 初期のcの値
        var tileUrl = 'https://grt.code4history.dev/tile/{c}/{z}/{x}/{y}';
        var tileLayer = L.tileLayer(tileUrl.replace('{c}', initialC), {
            minZoom: 0,
            maxZoom: 18,
            tileSize: 256
        }).addTo(map);
        
        function changeMaxValue() {
            let selectElement = document.getElementById('maxValueSelect');
            let selectedValue = selectElement.value;
            let value = parseFloat(selectedValue) / 2.0 ;
            let sliderElement = document.getElementById('slider1');
            sliderElement.setAttribute('max', selectedValue);
            sliderElement.setAttribute('value', String(value));
            updateMap();
        }        

        function updateMap() {
            var sliderValue = document.getElementById('slider1').value;
            tileLayer.setUrl(tileUrl.replace('{c}', sliderValue));
        }
        
        function updateValue() {
            var sliderValue = document.getElementById('slider1').value;
            document.getElementById('cc').innerText = sliderValue;
        }
    </script>
</body>
</html>

